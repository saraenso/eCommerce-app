var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},c={},n=e.parcelRequire716c;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in c){var n=c[e];delete c[e];var r={id:e,exports:{}};return t[e]=r,n.call(r.exports,r,r.exports),r.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){c[e]=t},e.parcelRequire716c=n);var r=n("CdASA");const o=(0,r.default)();async function d(){let e=0;try{let t=await o.getOrders(),c=document.querySelector(".selected-items-cart");for(let n of(c.innerHTML="",t)){let t=function(e){let t=document.createElement("li");t.className="selected-item-cart";let c=document.createElement("div");c.className="selected-item-cart__img-wrapper";let n=document.createElement("img");n.className="selected-item-cart__img",n.setAttribute("src",e.imageURL),n.setAttribute("alt",e.model),c.appendChild(n),t.appendChild(c);let r=document.createElement("div");r.className="selected-item-cart__desc-wrapper";let o=document.createElement("p");o.className="selected-item-cart__model",o.textContent=e.model,r.appendChild(o);let d=document.createElement("p");d.className="selected-item-cart__series",d.textContent=e.series,r.appendChild(d);let l=document.createElement("p");l.className="selected-item-cart__short-description",l.textContent=e.description.miniDescription,r.appendChild(l);let a=document.createElement("div");a.className="selected-item-cart__price-rating-wrapper";let s=document.createElement("div");s.className="selected-item-cart__price-wrapper";let u=document.createElement("p");u.className="selected-item-cart__price",u.textContent=`${e.currency} ${e.cost}`,s.appendChild(u);let m=document.createElement("p");m.className="x",m.textContent="x",s.appendChild(m);let i=document.createElement("p");return i.className="selected-item-cart__quantity",i.textContent=e.quantity,s.appendChild(i),a.appendChild(s),r.appendChild(a),t.appendChild(r),t}(n);c.appendChild(t),e+=n.cost*n.quantity}let n=document.querySelector(".goods-sum");n.textContent=`${t[0].currency} ${e.toFixed(2)}`;let r=document.querySelector(".delivery-cost");r.textContent=`${t[0].currency} ${6.99.toFixed(2)}`;let d=e+6.99,l=document.querySelector(".sum-up-amount");l.textContent=`${t[0].currency} ${d.toFixed(2)}`}catch(e){console.error("Error rendering selected items in cart:",e)}return{totalGoodsSum:e}}document.addEventListener("DOMContentLoaded",async function(){let{totalGoodsSum:e}=await d(),t=document.querySelector(".customer-info-change-button"),c=document.querySelector(".payment-type-change-button"),n=document.querySelector(".pop-up"),r=document.querySelector(".pop-up-payment");t.addEventListener("click",()=>{n.classList.add("pop-up-open");let e=JSON.parse(localStorage.getItem("customerData"));if(e){let t=document.querySelector(".name"),c=document.querySelector(".address"),n=document.querySelector(".city"),r=document.querySelector(".telephone");t.value=e.name,c.value=e.address,n.value=e.city,r.value=e.telephone}});let l=n.querySelector(".save");l.addEventListener("click",async()=>{let e=document.querySelector(".name"),t=document.querySelector(".address"),c=document.querySelector(".city"),r=document.querySelector(".telephone"),o=document.querySelector(".customers-name"),d=document.querySelector(".customers-address"),l=document.querySelector(".customers-city"),a=document.querySelector(".customers-telephone"),s={name:e.value,address:t.value,city:c.value,telephone:r.value};o.textContent=s.name,d.textContent=s.address,l.textContent=s.city,a.textContent=s.telephone;let u="",m=document.getElementById("card"),i=document.getElementById("cash");m.checked?u="Оплата картой при получении":i.checked&&(u="Оплата наличными при получении");let p=document.querySelector(".payment-checked-type");p.textContent=u,n.classList.remove("pop-up-open")});let a=document.querySelector(".pop-up-elements");n.addEventListener("click",e=>{e.composedPath().includes(a)||n.classList.remove("pop-up-open")}),c.addEventListener("click",()=>{r.classList.add("pop-up-open");let e=document.getElementById("card"),t=document.getElementById("cash");e.addEventListener("change",()=>{e.checked&&(t.checked=!1)}),t.addEventListener("change",()=>{t.checked&&(e.checked=!1)})});let s=r.querySelector(".save-btn");s.addEventListener("click",async()=>{let e=document.getElementById("card"),t=document.getElementById("cash"),c=document.querySelector(".payment-checked-type");e.checked?c.textContent="Оплата картой при получении":t.checked?c.textContent="Оплата наличными при получении":c.textContent="Способ оплаты не выбран",r.classList.remove("pop-up-open")});let u=document.querySelector(".pop-up-elements-payment");r.addEventListener("click",e=>{e.composedPath().includes(u)||r.classList.remove("pop-up-open")});let m=document.querySelector(".checkout-btn");m.addEventListener("click",async()=>{try{let t=document.querySelector(".customers-name").textContent.trim(),c=document.querySelector(".customers-address").textContent.trim(),n=document.querySelector(".customers-city").textContent.trim(),r=document.querySelector(".customers-telephone").textContent.trim(),d=document.getElementById("card"),l=document.getElementById("cash");if(""===t||""===c||""===n||""===r){alert("Пожалуйста, заполните все данные клиента.");return}if(!d.checked&&!l.checked){alert("Пожалуйста, выберите метод оплаты.");return}let a={name:document.querySelector(".customers-name").textContent,address:document.querySelector(".customers-address").textContent,city:document.querySelector(".customers-city").textContent,telephone:document.querySelector(".customers-telephone").textContent},s=document.querySelectorAll(".selected-item-cart"),u=[],m=0;s.forEach(e=>{let t=e.querySelector(".selected-item-cart__model").textContent,c=e.querySelector(".selected-item-cart__series").textContent,n=parseInt(e.querySelector(".selected-item-cart__quantity").textContent),r=parseFloat(e.querySelector(".selected-item-cart__price").textContent.replace(/[^\d.]/g,"")),o=e.querySelector(".selected-item-cart__price").textContent.replace(/[\d.]/g,"").trim(),d=e.querySelector(".selected-item-cart__img").getAttribute("src"),l=e.querySelector(".selected-item-cart__short-description").textContent;m+=r*n,u.push({model:t,series:c,quantity:n,cost:r,currency:o,miniDescription:l,imageURL:d})});let i=document.querySelector(".payment-checked-type").textContent;await o.addCompletedOrder({customerName:a.name,customerAddress:a.address,customerCity:a.city,customerTelephone:a.telephone,items:u,totalGoodsSum:e,totalAmount:e+6.99,payMethod:i}),window.location.href="order.html"}catch(e){console.error("Ошибка:",e)}})});